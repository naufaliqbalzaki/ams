import{r as _,j as e,W as C}from"./app-CgyQeRWE.js";import{I as l}from"./InputError-B0JEf8YU.js";import{c as h,B as x}from"./button-B8vYVqyT.js";import{S as F,a as S,b as I,c as D,d as P,e as L,P as p,f as g,g as j,C as b}from"./popover-aKBOASnK.js";import{I as c}from"./input-BLhrMaN-.js";import{L as n}from"./label-DyF9zx_6.js";import{C as v}from"./index-B1jJIOIw.js";import"./index-D7EVMudf.js";import"./index-C182Cx1n.js";import"./index-Bmk89TnL.js";import"./Combination-CxV1gsB8.js";import"./index-CpsOBOZ-.js";import"./index-DGmbteZG.js";const d=_.forwardRef(({className:u,...m},a)=>e.jsx("textarea",{className:h("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",u),ref:a,...m}));d.displayName="Textarea";const q=({userId:u,docType:m,document:a,instances:N})=>{a&&(a.issue_date&&(a.issue_date=new Date(a.issue_date)),a.verification_date&&(a.verification_date=new Date(a.verification_date)));const{data:i,setData:s,post:f,processing:w,errors:r}=C(a||{user_id:u,instance_id:"",doc_type:m,number:"",issue_date:new Date,verification_date:new Date,subject:"",from:"",file:new File([],"file"),phone:"",next_action:"",corrective_action:"",description:"",_method:"post"}),k=t=>{if(t.preventDefault(),s("doc_type",m),a&&a.id&&(i._method="put",f(route("documents.update",a.id),{forceFormData:!0})),!a){i._method="post",console.log(i);const o=route("documents.store");console.log(o),f(route("documents.store"))}};_.useEffect(()=>{a?(s("instance_id",a.instance_id),s("number",a.number),s("doc_type",a.doc_type),s("issue_date",a.issue_date),s("verification_date",a.verification_date),s("from",a.from),s("subject",a.subject),s("file",a.file),s("phone",a.phone),s("next_action",a.next_action),s("corrective_action",a.corrective_action),s("description",a.description)):s("doc_type",m)},[s]);const y=t=>{t.target.files&&s("file",t.target.files[0])};return e.jsxs("form",{onSubmit:k,children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"instance_id",children:"Dinas"}),e.jsxs(F,{value:i.instance_id,onValueChange:t=>s("instance_id",t),children:[e.jsx(S,{className:"mt-2",children:e.jsx(I,{placeholder:"Pilih dinas"})}),e.jsx(D,{children:e.jsx(P,{children:N.map(t=>e.jsx(L,{value:t.id.toString(),children:t.name},t.id))})})]}),e.jsx(l,{message:r.instance_id,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(n,{htmlFor:"number",children:"No."}),e.jsx(c,{id:"number",type:"text",name:"number",value:i.number,className:"block w-full mt-1",onChange:t=>s("number",t.target.value)}),e.jsx(l,{message:r.number,className:"mt-2"})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsx(n,{htmlFor:"issue_date",children:"Tanggal Terbit"}),e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsxs(x,{variant:"outline",className:h("w-[280px] justify-start text-left font-normal",!i.issue_date&&"text-muted-foreground"),children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),i.issue_date?`${i.issue_date.toLocaleString([],{year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"})}`:e.jsx("span",{children:"Pilih tanggal terbit"})]})}),e.jsxs(j,{className:"w-auto p-0",children:[e.jsx(b,{mode:"single",selected:i.issue_date,onSelect:t=>{t&&s("issue_date",t)},initialFocus:!0})," ",e.jsx(c,{type:"time",className:"mt-2 bg-neutral-50 border leading-none border-neutral-300 text-neutral-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-neutral-700 dark:border-neutral-600 dark:placeholder-neutral-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 ",value:i.issue_date.toLocaleTimeString([],{hourCycle:"h23",hour:"2-digit",minute:"2-digit"}),onChange:t=>{const o=i.issue_date;o.setHours(parseInt(t.target.value.split(":")[0]),parseInt(t.target.value.split(":")[1]),0),s("issue_date",o)}})]})]}),e.jsx(l,{message:r.issue_date,className:"mt-2"})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsx(n,{htmlFor:"verification_date",children:"Tanggal Verifikasi"}),e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsxs(x,{variant:"outline",className:h("w-[280px] justify-start text-left font-normal",!i.verification_date&&"text-muted-foreground"),children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),i.verification_date?`${i.verification_date.toLocaleString([],{year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"})}`:e.jsx("span",{children:"Pilih tanggal verifikasi"})]})}),e.jsxs(j,{className:"w-auto p-0",children:[e.jsx(b,{mode:"single",selected:i.verification_date,onSelect:t=>{t&&s("verification_date",t)},initialFocus:!0})," ",e.jsx(c,{type:"time",className:"mt-2 bg-neutral-50 border leading-none border-neutral-300 text-neutral-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-neutral-700 dark:border-neutral-600 dark:placeholder-neutral-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 ",value:i.verification_date.toLocaleTimeString([],{hourCycle:"h23",hour:"2-digit",minute:"2-digit"}),onChange:t=>{const o=i.verification_date;o.setHours(parseInt(t.target.value.split(":")[0]),parseInt(t.target.value.split(":")[1]),0),s("verification_date",o)}})]})]}),e.jsx(l,{message:r.verification_date,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(n,{htmlFor:"from",children:"Pemohon"}),e.jsx(c,{id:"from",type:"text",name:"from",value:i.from,className:"block w-full mt-1",onChange:t=>s("from",t.target.value)}),e.jsx(l,{message:r.from,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(n,{htmlFor:"subject",children:"Perizinan"}),e.jsx(d,{id:"subject",name:"subject",value:i.subject,className:"block w-full mt-1",onChange:t=>s("subject",t.target.value)}),e.jsx(l,{message:r.subject,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(n,{htmlFor:"file",children:"Lampiran"}),e.jsx(c,{id:"file",type:"file",name:"file",className:"block w-full mt-1 file:text-foreground",accept:"application/*",onChange:y}),e.jsx(l,{message:r.file,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(n,{htmlFor:"phone",children:"No. Telp"}),e.jsx(c,{id:"phone",type:"text",name:"phone",value:i.phone,className:"block w-full mt-1",onChange:t=>s("phone",t.target.value)}),e.jsx(l,{message:r.phone,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(n,{htmlFor:"next_action",children:"Aksi Lanjutan"}),e.jsx(d,{id:"next_action",name:"next_action",value:i.next_action,className:"block w-full mt-1",onChange:t=>s("next_action",t.target.value)}),e.jsx(l,{message:r.next_action,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(n,{htmlFor:"corrective_action",children:"Aksi Koreksi"}),e.jsx(d,{id:"corrective_action",name:"corrective_action",value:i.corrective_action,className:"block w-full mt-1",onChange:t=>s("corrective_action",t.target.value)}),e.jsx(l,{message:r.corrective_action,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(n,{htmlFor:"description",children:"Keterangan"}),e.jsx(d,{id:"description",name:"description",value:i.description,className:"block w-full mt-1",onChange:t=>s("description",t.target.value)}),e.jsx(l,{message:r.description,className:"mt-2"})]}),e.jsx("div",{className:"flex items-center justify-between mt-4",children:e.jsx(x,{type:"submit",className:"w-full mt-2",disabled:w,children:a?"Ubah":"Buat"})})]})};export{q as DocumentForm};
